{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useCart}from'../context/CartContext';import{formatCurrency}from'../utils/currency';import{Link,useNavigate}from'react-router-dom';import{useAuth}from'../context/AuthContext';import axios from'axios';import BACKEND_URL from'../config';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ProductCard=_ref=>{let{product}=_ref;const{addToCart}=useCart();const{user}=useAuth();const navigate=useNavigate();const[isWishlisted,setIsWishlisted]=useState(false);useEffect(()=>{const checkWishlistStatus=async()=>{if(!user)return;try{const token=localStorage.getItem('token');const response=await axios.get(\"\".concat(BACKEND_URL,\"/api/wishlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});const wishlisted=response.data.wishlist.some(item=>item.productId===product.id);setIsWishlisted(wishlisted);}catch(error){var _error$response,_error$response$data;console.error('Failed to fetch wishlist status:',((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||error.message);}};checkWishlistStatus();},[user,product.id]);const handleToggleWishlist=async event=>{event.stopPropagation();// Prevent card click\nif(!user){navigate('/login');return;}try{const token=localStorage.getItem('token');if(isWishlisted){await axios.delete(\"\".concat(BACKEND_URL,\"/api/wishlist/\").concat(product.id),{headers:{'Authorization':\"Bearer \".concat(token)}});setIsWishlisted(false);}else{await axios.post(\"\".concat(BACKEND_URL,\"/api/wishlist\"),{productId:product.id},{headers:{'Authorization':\"Bearer \".concat(token)}});setIsWishlisted(true);}}catch(error){var _error$response2,_error$response2$data;console.error('Failed to toggle wishlist:',((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||error.message);}};const discountedPrice=product.discount?product.price*(1-product.discount/100):product.price;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300 flex flex-col h-[28rem] relative\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleToggleWishlist,className:\"absolute top-2 right-2 z-10 p-2 rounded-full \".concat(isWishlisted?'text-red-500 bg-red-100':'text-gray-400 bg-white',\" hover:text-red-500 hover:bg-red-100 transition-colors duration-300\"),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-heart text-xl\"})}),/*#__PURE__*/_jsxs(Link,{to:\"/products/\".concat(product.id),className:\"block flex flex-col h-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-64 bg-gray-200 flex items-center justify-center overflow-hidden\",children:product.images&&product.images.length>0?/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(BACKEND_URL).concat(product.images[0].url),alt:product.title,className:\"w-full h-full object-cover transform hover:scale-105 transition-transform duration-300\"}):/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl text-gray-400\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-2 mt-auto\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold mb-2 text-base-text leading-tight line-clamp-2\",children:product.title}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-baseline mb-3\",children:product.discount>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-bold text-base-text\",children:formatCurrency(discountedPrice)}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-sm text-gray-500 line-through\",children:formatCurrency(product.price)}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-sm font-bold text-green-600\",children:[product.discount,\"% off\"]})]}):/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-bold text-base-text\",children:formatCurrency(product.price)})})]})]})]});};export default ProductCard;","map":{"version":3,"names":["React","useState","useEffect","useCart","formatCurrency","Link","useNavigate","useAuth","axios","BACKEND_URL","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProductCard","_ref","product","addToCart","user","navigate","isWishlisted","setIsWishlisted","checkWishlistStatus","token","localStorage","getItem","response","get","concat","headers","wishlisted","data","wishlist","some","item","productId","id","error","_error$response","_error$response$data","console","message","handleToggleWishlist","event","stopPropagation","delete","post","_error$response2","_error$response2$data","discountedPrice","discount","price","className","children","onClick","to","images","length","src","url","alt","title"],"sources":["C:/Users/flyin/Desktop/WEBSITE/frontend/src/components/ProductCard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useCart } from '../context/CartContext';\nimport { formatCurrency } from '../utils/currency';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport axios from 'axios';\nimport BACKEND_URL from '../config';\n\nconst ProductCard = ({ product }) => {\n  const { addToCart } = useCart();\n  const { user } = useAuth();\n  const navigate = useNavigate();\n  const [isWishlisted, setIsWishlisted] = useState(false);\n\n  useEffect(() => {\n    const checkWishlistStatus = async () => {\n      if (!user) return;\n      try {\n        const token = localStorage.getItem('token');\n        const response = await axios.get(`${BACKEND_URL}/api/wishlist`, {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n          },\n        });\n        const wishlisted = response.data.wishlist.some(item => item.productId === product.id);\n        setIsWishlisted(wishlisted);\n      } catch (error) {\n        console.error('Failed to fetch wishlist status:', error.response?.data?.error || error.message);\n      }\n    };\n    checkWishlistStatus();\n  }, [user, product.id]);\n\n  const handleToggleWishlist = async (event) => {\n    event.stopPropagation(); // Prevent card click\n    if (!user) {\n      navigate('/login');\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('token');\n      if (isWishlisted) {\n        await axios.delete(`${BACKEND_URL}/api/wishlist/${product.id}`, {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n          },\n        });\n        setIsWishlisted(false);\n      } else {\n        await axios.post(`${BACKEND_URL}/api/wishlist`, { productId: product.id }, {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n          },\n        });\n        setIsWishlisted(true);\n      }\n    } catch (error) {\n      console.error('Failed to toggle wishlist:', error.response?.data?.error || error.message);\n    }\n  };\n\n  const discountedPrice = product.discount \n    ? product.price * (1 - product.discount / 100)\n    : product.price;\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300 flex flex-col h-[28rem] relative\">\n      <button\n        onClick={handleToggleWishlist}\n        className={`absolute top-2 right-2 z-10 p-2 rounded-full ${isWishlisted ? 'text-red-500 bg-red-100' : 'text-gray-400 bg-white'} hover:text-red-500 hover:bg-red-100 transition-colors duration-300`}\n      >\n        <i className=\"fas fa-heart text-xl\"></i>\n      </button>\n      <Link to={`/products/${product.id}`} className=\"block flex flex-col h-full\"> \n        <div className=\"h-64 bg-gray-200 flex items-center justify-center overflow-hidden\">\n          {product.images && product.images.length > 0 ? (\n            <img \n              src={`${BACKEND_URL}${product.images[0].url}`}\n              alt={product.title} \n              className=\"w-full h-full object-cover transform hover:scale-105 transition-transform duration-300\"\n            />\n          ) : (\n            <div className=\"text-4xl text-gray-400\">\n              <i className=\"fas fa-camera\"></i>\n            </div>\n          )}\n        </div>\n        <div className=\"px-4 py-2 mt-auto\"> \n          <h3 className=\"text-xl font-bold mb-2 text-base-text leading-tight line-clamp-2\">{product.title}</h3>\n\n          <div className=\"flex items-baseline mb-3\">\n            {product.discount > 0 ? (\n              <>\n                <span className=\"text-lg font-bold text-base-text\">{formatCurrency(discountedPrice)}</span>\n                <span className=\"ml-2 text-sm text-gray-500 line-through\">{formatCurrency(product.price)}</span>\n                <span className=\"ml-2 text-sm font-bold text-green-600\">{product.discount}% off</span>\n              </>\n            ) : (\n              <span className=\"text-lg font-bold text-base-text\">{formatCurrency(product.price)}</span>\n            )}\n          </div>\n        </div>\n      </Link>\n    </div>\n  );\n};\n\nexport default ProductCard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}